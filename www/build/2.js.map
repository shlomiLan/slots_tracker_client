{"version":3,"sources":["../../src/pages/modal/expense/expense-modal.module.ts","../../src/pages/modal/expense/expense-modal.ts"],"names":[],"mappings":"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","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { ExpenseModalPage } from './expense-modal';\n\n@NgModule({\n  declarations: [\n    ExpenseModalPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(ExpenseModalPage),\n  ],\n})\nexport class ModalPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal/expense/expense-modal.module.ts","import {Component} from '@angular/core';\nimport {FormArray, FormBuilder, FormGroup, Validators} from '@angular/forms';\nimport {IonicPage, NavParams, ViewController} from 'ionic-angular';\nimport {ApiServiceProvider} from \"../../../providers/api-service/api-service\";\n\n@IonicPage()\n@Component({\n  template: `\n    <ion-header>\n      <ion-navbar>\n        <ion-buttons>\n          <button ion-button (click)=\"closeModal()\">Close</button>\n        </ion-buttons>\n      </ion-navbar>\n    </ion-header>\n\n    <ion-content padding>\n      <form [formGroup]=\"expense\" (ngSubmit)=\"saveData()\" *ngIf=\"expense && categories_form && methods_form\">\n        <ion-item>\n          <ion-label>Amount:</ion-label>\n          <ion-input formControlName=\"amount\" type=\"number\"></ion-input>\n        </ion-item>\n        <ion-item>\n          <ion-label>Description:</ion-label>\n          <ion-input formControlName=\"description\" type=\"text\"></ion-input>\n        </ion-item>\n        <ion-item>\n          <ion-label>Category:</ion-label>\n          <ion-select formControlName=\"category\" (ionChange)=\"categoryChange($event);\" interface=\"popover\">\n            <ion-option *ngFor=\"let item of categories_form.controls\" [value]=\"item.value._id\">\n              {{item.value.name}}\n            </ion-option>\n          </ion-select>\n        </ion-item>\n        <ion-item>\n          <ion-label>Pay method:</ion-label>\n          <ion-select formControlName=\"pay_method\" (ionChange)=\"payMethodChange($event);\" interface=\"popover\">\n            <ion-option *ngFor=\"let item of methods_form.controls\" [value]=\"item.value._id\">\n              {{item.value.name}}\n            </ion-option>\n          </ion-select>\n        </ion-item>\n        <ion-item>\n          <ion-label>Date:</ion-label>\n          <ion-datetime displayFormat=\"D MMM YYYY\" formControlName=\"timestamp\"></ion-datetime>\n        </ion-item>\n        <ion-item>\n          <ion-label>One time</ion-label>\n          <ion-checkbox color=\"dark\" formControlName=\"one_time\"></ion-checkbox>\n        </ion-item>\n\n        <ion-item *ngIf=\"is_new\">\n          <ion-label>Payments:</ion-label>\n          <ion-input formControlName=\"payments\" type=\"number\" [min]=\"1\"></ion-input>\n        </ion-item>\n\n        <ion-buttons end>\n          <button ion-button type=\"submit\" [disabled]=\"!expense.valid\">Submit</button>\n        </ion-buttons>\n      </form>\n    </ion-content>\n  `\n})\n\nexport class ExpenseModalPage {\n  private expense: FormGroup;\n  private methods_form: FormArray;\n  private categories_form: FormArray;\n  private readonly is_new: boolean;\n\n  private methods: any;\n  private categories: any;\n  private error_msg: string;\n\n  constructor(private navParams: NavParams, private formBuilder: FormBuilder, private viewCtrl: ViewController,\n              private api: ApiServiceProvider) {\n\n    // Initialize data\n    this.error_msg = '';\n    this.getPayMethods();\n    this.getCategories();\n    this.is_new = this.navParams.get('is_new');\n    let expense_data = Object.assign({}, this.navParams.get('data'));\n\n    // Add the payment field only if create new expense\n    if (this.is_new == true) {\n      expense_data['payments'] = 1;\n    }\n\n    for (let prop of Object.keys(expense_data)) {\n      expense_data[prop] = [expense_data[prop], [Validators.required]];\n\n      if (prop == 'payments') {\n        expense_data[prop][1].push(Validators.min(1));\n      }\n    }\n\n    this.expense = this.formBuilder.group(expense_data);\n\n    // Modify the pay_method and category data for the select element\n    this.expense.controls['pay_method'].setValue(this.expense.value.pay_method._id);\n    this.expense.controls['category'].setValue(this.expense.value.category._id);\n  }\n\n  saveData() {\n    this.expense.controls['pay_method'].setValue({\"_id\": this.expense.value.pay_method});\n    this.expense.controls['category'].setValue({\"_id\": this.expense.value.category});\n    this.viewCtrl.dismiss(this.expense.value);\n  }\n\n  closeModal() {\n    this.viewCtrl.dismiss();\n  }\n\n  payMethodChange(value) {\n    this.expense.controls['pay_method'].setValue(value);\n  }\n\n  categoryChange(value) {\n    this.expense.controls['category'].setValue(value);\n  }\n\n  getPayMethods() {\n    this.api.getPayMethods().subscribe(response => {\n      this.methods = response;\n      this.methods_form = this.formBuilder.array(this.methods);\n    }, err => {\n      this.error_msg = this.error_msg.concat('In getPayMethods: ', err.error);\n      this.close_and_display_error(err);\n    });\n  }\n\n  getCategories() {\n    this.api.getCategories().subscribe(response => {\n      this.categories = response;\n      this.categories_form = this.formBuilder.array(this.categories);\n    }, err => {\n      this.error_msg = this.error_msg.concat('In getCategories: ', err.error);\n      this.close_and_display_error(err);\n    });\n  }\n\n  close_and_display_error(err) {\n    this.viewCtrl.dismiss(err);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/modal/expense/expense-modal.ts"],"sourceRoot":""}